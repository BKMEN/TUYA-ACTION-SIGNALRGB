import dgram from 'dgram';

export function createSocket(options = 'udp4') {
    const socket = dgram.createSocket(options);

    socket.write = function(data, ip, port) {
        const buffer = Buffer.isBuffer(data)
            ? data
            : Buffer.from(data instanceof ArrayBuffer ? new Uint8Array(data) : data);
        socket._remoteIp = ip;
        socket._remotePort = port;
        socket.send(buffer, 0, buffer.length, port, ip);
    };

    socket.remoteAddress = function() {
        return { address: socket._remoteIp, port: socket._remotePort };
    };

    return socket;
}

export default { createSocket };
